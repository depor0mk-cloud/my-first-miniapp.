<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>HKos Hardcore Beta</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --bg: #000; --card-bg: #0a0a0a; --neon: #00ff88; --shadow: 0 0 15px rgba(0,255,136,0.5); }
        * { -webkit-tap-highlight-color: transparent; user-select: none; box-sizing: border-box; }
        body, html { margin: 0; padding: 0; background: var(--bg); color: #fff; font-family: 'Arial Black', sans-serif; height: 100vh; overflow: hidden; }
        canvas { position: fixed; top: 0; left: 0; z-index: -1; opacity: 0.15; }
        .app-wrapper { display: flex; flex-direction: column; height: 100vh; padding: 15px 20px 90px; }
        .card { background: var(--card-bg); border-radius: 35px; padding: 30px 20px; text-align: center; border: 1px solid rgba(255,255,255,0.05); margin-bottom: 15px; }
        .hkos-val { font-size: 42px; font-weight: 900; color: var(--neon); text-shadow: var(--shadow); font-family: monospace; }
        .btn-3d { background: var(--neon); color: #000; border: none; padding: 15px; border-radius: 15px; font-weight: 900; font-size: 16px; box-shadow: 0 4px 0 #008844; cursor: pointer; width: 100%; }
        .btn-3d:active { transform: translateY(2px); box-shadow: 0 2px 0 #008844; }
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 20000; display: none; align-items: center; justify-content: center; opacity: 0; transition: 0.3s; }
        .modal-content { background: #0f0f0f; border: 3px solid var(--neon); border-radius: 40px; padding: 40px 25px; text-align: center; width: 85%; transform: scale(0.8); transition: 0.3s; box-shadow: var(--shadow); }
        .modal-overlay.show { opacity: 1; display: flex; }
        .modal-overlay.show .modal-content { transform: scale(1); }
        .progress-box { width: 100%; background: #111; height: 15px; border-radius: 10px; margin: 20px 0; overflow: hidden; }
        .bar { width: 0%; height: 100%; background: var(--neon); box-shadow: var(--shadow); transition: 0.1s; }
        .nav { position: fixed; bottom: 30px; left: 20px; right: 20px; display: flex; justify-content: space-around; padding: 18px; background: rgba(10,10,10,0.95); backdrop-filter: blur(15px); border-radius: 25px; border: 1px solid rgba(255,255,255,0.08); }
        .nav-item { font-size: 11px; font-weight: 900; color: #444; text-transform: uppercase; border: none; background: none; }
        .nav-item.active { color: var(--neon); text-shadow: var(--shadow); }
        .screen { display: none; flex-direction: column; height: 100%; }
        .screen.active { display: flex; }
        input { background: transparent; border: none; color: var(--neon); text-align: center; width: 100%; outline: none; font-weight: 900; font-size: 18px; text-shadow: var(--shadow); padding: 5px; }
        #ban-screen { position: fixed; inset: 0; background: #000; z-index: 30000; display: none; flex-direction: column; align-items: center; justify-content: center; padding: 20px; }
    </style>
</head>
<body>
<canvas id="matrix"></canvas>

<div id="m-reward" class="modal-overlay">
    <div class="modal-content">
        <div style="font-size: 60px;">üíé</div>
        <h2 style="font-weight: 900;">–£–°–ü–ï–•!</h2>
        <div id="reward-amt" style="font-size: 28px; color: var(--neon); font-weight: 900; margin: 20px 0;">+0.0000 HKos</div>
        <button class="btn-3d" onclick="closeM('m-reward')">–ó–ê–ë–†–ê–¢–¨</button>
    </div>
</div>

<div id="m-promo" class="modal-overlay">
    <div class="modal-content">
        <div style="font-size: 60px;">üîë</div>
        <h2 style="font-weight: 900;">–ê–ö–¢–ò–í–ê–¶–ò–Ø</h2>
        <div id="promo-val-text" style="font-size: 28px; color: var(--neon); font-weight: 900; margin: 20px 0;">+0.0000 HKos</div>
        <button class="btn-3d" onclick="closeM('m-promo')">–û–¢–õ–ò–ß–ù–û</button>
    </div>
</div>

<div id="ban-screen">
    <h1 style="color: #ff3e3e; font-weight: 900;">SYSTEM BLOCKED</h1>
    <p style="color: #555;">SECURITY ALERT: HIGH CPS</p>
    <input type="text" id="adm-unlock" placeholder="CODE" oninput="checkAdm()" style="margin-top: 30px;">
</div>

<div class="app-wrapper">
    <div id="home-screen" class="screen active">
        <div class="card">
            <div style="font-size: 10px; color: #444; font-weight: 900;">–ë–ê–õ–ê–ù–° HKos</div>
            <div id="hk-num" class="hkos-val">0.00000000</div>
            <div id="ps-num" style="font-size: 13px; color: #555;">0.00000 HK/s</div>
        </div>

        <div id="p-area" class="card" style="padding: 20px; border: 2px dashed #111;">
            <input type="text" id="p-input" placeholder="–í–í–ï–î–ò–¢–ï –ü–†–û–ú–û–ö–û–î" oninput="checkPr()">
        </div>

        <div style="overflow-y: auto; flex: 1;">
            <div class="card" style="display:flex; justify-content:space-between; align-items:center; padding: 20px;">
                <div style="text-align:left;"><b>–°–õ–ê–ë–´–ô</b><br><small style="color:var(--neon);">+0.07/—á</small></div>
                <button class="btn-3d" style="width: 100px;" onclick="buy(3, 0.07)">3 HK</button>
            </div>
            <div class="card" style="display:flex; justify-content:space-between; align-items:center; padding: 20px;">
                <div style="text-align:left;"><b>–°–†–ï–î–ù–ò–ô</b><br><small style="color:var(--neon);">+0.40/—á</small></div>
                <button class="btn-3d" style="width: 100px;" onclick="buy(15, 0.4)">15 HK</button>
            </div>
            <div class="card" style="display:flex; justify-content:space-between; align-items:center; padding: 20px;">
                <div style="text-align:left;"><b>–ú–û–©–ù–´–ô</b><br><small style="color:var(--neon);">+1.50/—á</small></div>
                <button class="btn-3d" style="width: 100px;" onclick="buy(50, 1.5)">50 HK</button>
            </div>
        </div>
    </div>

    <div id="click-screen" class="screen">
        <div class="card">
            <h2 id="target-txt" style="margin: 0; font-weight: 900;">–¶–ï–õ–¨: 10 –¢–ê–ü–û–í</h2>
            <div class="progress-box"><div id="bar" class="bar"></div></div>
            <button class="btn-3d" style="padding: 60px; font-size: 32px;" onclick="tap()">TAP</button>
        </div>
    </div>

    <div id="store-screen" class="screen">
        <div style="text-align:center; margin-top: 150px;">
            <div style="font-size: 60px; opacity: 0.3;">üõí</div>
            <h2 style="color: #222; letter-spacing: 8px; font-weight: 900;">–°–ö–û–†–û...</h2>
        </div>
    </div>

    <div class="nav">
        <button id="n-home" class="nav-item active" onclick="nav('home')">–ì–õ–ê–í–ù–û–ï</button>
        <button id="n-click" class="nav-item" onclick="nav('click')">–ö–õ–ò–ö–ï–†</button>
        <button id="n-store" class="nav-item" onclick="nav('store')">–ú–ê–ì–ê–ó–ò–ù</button>
    </div>
</div>

<script>
    const tg = window.Telegram.WebApp;
    tg.expand(); tg.ready();

    const _S = {
        k: ['h_v4', 'p_v4', 's_v4', 'b_v4', 'u_v4', 'v_v4'],
        // –ê–¥–º–∏–Ω–∫–∞: /–°–ù–Ø–¢–¨–ë–ê–ù, /–°–ù–Ø–¢–¨–ú–£–¢, /–°–ù–Ø–¢–¨48
        a: ["L9Ch0J3QrNCi0KzQkdCQ0J0=", "L9Ch0J3QrNCi0KzQnNCj0KI=", "L9Ch0J3QrNCi0KzQndCQNDg="],
        // –ü—Ä–æ–º–æ 1 (5HK): –ß–õ–ï–ù–û–ü–û–¢–ê–ú
        p1: "0KfQm9CV0J3QntCf0J7QotCQ0J0=",
        // –ü—Ä–æ–º–æ 2 (10HK): MANDA
        p2: "TUFOREE="
    };

    let hk = parseFloat(localStorage.getItem(_S.k[0])) || 0;
    let hp = parseFloat(localStorage.getItem(_S.k[1])) || 0.02;
    let si = parseInt(localStorage.getItem(_S.k[2])) || 0;
    let ib = localStorage.getItem(_S.k[3]) === 'true';
    let pu = JSON.parse(localStorage.getItem(_S.k[4]) || "[]"); // –ú–∞—Å—Å–∏–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–æ–º–æ
    let lv = parseInt(localStorage.getItem(_S.k[5])) || Date.now();
    let stp = [10, 15, 20, 30, 50, 80, 100], cc = 0, ct = [];

    const _dec = (s) => {
        try { return decodeURIComponent(escape(atob(s))); } catch(e) { return atob(s); }
    };

    function sync() {
        document.getElementById('hk-num').innerText = hk.toFixed(8);
        document.getElementById('ps-num').innerText = (hp/3600).toFixed(5) + " HK/s";
    }

    function openM(id, txt) {
        if(txt) document.getElementById('promo-val-text').innerText = txt;
        const m = document.getElementById(id); m.style.display = 'flex';
        setTimeout(() => m.classList.add('show'), 10);
        tg.HapticFeedback.notificationOccurred('success');
    }

    function closeM(id) {
        const m = document.getElementById(id); m.classList.remove('show');
        setTimeout(() => m.style.display = 'none', 300);
    }

    function tap() {
        if(ib) return;
        const n = Date.now(); ct.push(n);
        ct = ct.filter(t => n - t < 1000);
        if(ct.length > 13) { ib = true; localStorage.setItem(_S.k[3], 'true'); location.reload(); return; }
        cc++;
        let t = stp[si] || (100 + (si-6)*20);
        document.getElementById('bar').style.width = (cc/t*100) + "%";
        tg.HapticFeedback.impactOccurred('medium');
        if(cc >= t) {
            let r = Math.random() < 0.1 ? 0.015 : 0.003;
            hk += r; cc = 0; si++;
            localStorage.setItem(_S.k[2], si);
            document.getElementById('target-txt').innerText = "–¶–ï–õ–¨: " + (stp[si] || (100 + (si-6)*20)) + " –¢–ê–ü–û–í";
            document.getElementById('reward-amt').innerText = "+" + r.toFixed(4) + " HKos";
            openM('m-reward'); sync();
        }
    }

    function checkPr() {
        let v = document.getElementById('p-input').value.trim().toUpperCase();
        if(!v) return;

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ê–¥–º–∏–Ω–∫–∏
        if (_S.a.some(a => v === _dec(a))) {
            ib = false; localStorage.setItem(_S.k[3], 'false');
            document.getElementById('ban-screen').style.display = 'none';
            document.getElementById('p-input').value = "";
            tg.showAlert("–ë–ê–ù –°–ù–Ø–¢"); return;
        }

        // –õ–æ–≥–∏–∫–∞ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
        let promoKey = "";
        let reward = 0;

        if (v === _dec(_S.p1)) { promoKey = "p1"; reward = 5; }
        else if (v === _dec(_S.p2)) { promoKey = "p2"; reward = 10; }

        if (promoKey) {
            if (pu.includes(promoKey)) {
                tg.showAlert("–£–ñ–ï –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–û");
                document.getElementById('p-input').value = "";
            } else {
                hk += reward;
                pu.push(promoKey);
                localStorage.setItem(_S.k[4], JSON.stringify(pu));
                document.getElementById('p-input').value = "";
                openM('m-promo', "+" + reward.toFixed(4) + " HKos");
                sync();
            }
        }
    }

    function checkAdm() {
        let v = document.getElementById('adm-unlock').value.toUpperCase();
        if (_S.a.some(a => v === _dec(a))) { ib = false; localStorage.setItem(_S.k[3], 'false'); location.reload(); }
    }

    function buy(c, p) {
        if(hk >= c) { hk -= c; hp += p; tg.HapticFeedback.notificationOccurred('success'); sync(); }
        else tg.showAlert("–ú–ê–õ–û HKos");
    }

    function nav(s) {
        document.querySelectorAll('.screen').forEach(e => e.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(e => e.classList.remove('active'));
        document.getElementById(s + '-screen').classList.add('active');
        document.getElementById('n-' + s).classList.add('active');
        tg.HapticFeedback.selectionChanged();
    }

    // –ú–∞—Ç—Ä–∏—Ü–∞ –Ω–∞ —Ñ–æ–Ω–µ
    const cv = document.getElementById('matrix'), cx = cv.getContext('2d');
    cv.width = window.innerWidth; cv.height = window.innerHeight;
    const dr = Array(Math.floor(cv.width/10)).fill(1);
    function draw() {
        cx.fillStyle = "rgba(0,0,0,0.05)"; cx.fillRect(0,0,cv.width,cv.height);
        cx.fillStyle = "#0f8"; cx.font = "10px monospace";
        dr.forEach((y, i) => {
            cx.fillText(Math.random() > 0.5 ? "0" : "1", i*10, y*10);
            if(y*10 > cv.height && Math.random() > 0.975) dr[i] = 0;
            dr[i]++;
        });
    }
    setInterval(draw, 50);

    setInterval(() => { hk += hp/3600/20; sync(); }, 50);
    setInterval(() => {
        localStorage.setItem(_S.k[0], hk.toFixed(10));
        localStorage.setItem(_S.k[1], hp.toFixed(8));
        localStorage.setItem(_S.k[5], Date.now());
    }, 5000);

    if(ib) document.getElementById('ban-screen').style.display = 'flex';
    document.getElementById('target-txt').innerText = "–¶–ï–õ–¨: " + (stp[si] || (100 + (si-6)*20)) + " –¢–ê–ü–û–í";
    sync();
</script>
</body>
</html>
