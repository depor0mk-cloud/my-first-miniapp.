<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Hakos Clicker Elite</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg: #0f172a;
            --accent: #38bdf8;
            --card: #1e293b;
            --text-main: #f8fafc;
            --text-dim: #94a3b8;
        }

        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent; /* –£–±–∏—Ä–∞–µ—Ç —Å–∏–Ω–∏–π –∫–≤–∞–¥—Ä–∞—Ç */
        }

        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background-color: var(--bg);
            color: var(--text-main);
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
            overflow: hidden;
            user-select: none;
        }

        /* –®–∞–ø–∫–∞ */
        .header {
            width: 100%;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .stat-badge {
            background: var(--card);
            padding: 8px 16px;
            border-radius: 12px;
            border: 1px solid #334155;
            font-size: 14px;
        }

        /* –°—á–µ—Ç */
        #score-container {
            text-align: center;
            margin-top: 20px;
        }

        #score {
            font-size: 64px;
            font-weight: 800;
            background: linear-gradient(to bottom, #fff, #38bdf8);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* 3D –ö–Ω–æ–ø–∫–∞ */
        .btn-wrapper {
            margin-top: 50px;
            position: relative;
        }

        #click-btn {
            width: 220px;
            height: 220px;
            background: #0284c7;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            position: relative;
            box-shadow: 
                0 15px 0 #0369a1, /* –ì–ª—É–±–∏–Ω–∞ –∫–Ω–æ–ø–∫–∏ */
                0 20px 30px rgba(0,0,0,0.5);
            transition: all 0.05s ease;
            border: none;
        }

        #click-btn:active {
            transform: translateY(10px); /* –í–¥–∞–≤–ª–∏–≤–∞–Ω–∏–µ */
            box-shadow: 
                0 5px 0 #0369a1,
                0 10px 20px rgba(0,0,0,0.5);
        }

        .h-logo {
            font-size: 110px;
            font-weight: 900;
            color: white;
            text-shadow: 0 4px 4px rgba(0,0,0,0.2);
        }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .nav-bar {
            position: fixed;
            bottom: 30px;
            display: flex;
            gap: 15px;
            width: 90%;
        }

        .nav-btn {
            flex: 1;
            background: var(--card);
            border: 1px solid #334155;
            color: white;
            padding: 15px;
            border-radius: 16px;
            font-weight: bold;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        /* –ú–∞–≥–∞–∑–∏–Ω –∏ –õ–∏–¥–µ—Ä—ã (Overlay) */
        .overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg);
            z-index: 1000;
            display: none;
            padding: 20px;
            overflow-y: auto;
        }

        .overlay.active { display: block; }

        .close-btn {
            padding: 10px;
            background: var(--card);
            border-radius: 10px;
            margin-bottom: 20px;
            display: inline-block;
        }

        .shop-item {
            background: var(--card);
            padding: 15px;
            border-radius: 16px;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid #334155;
        }

        .buy-btn {
            background: var(--accent);
            color: #000;
            border: none;
            padding: 10px 15px;
            border-radius: 10px;
            font-weight: 800;
        }

        .buy-btn:disabled { opacity: 0.3; }

        .leader-row {
            display: flex;
            justify-content: space-between;
            padding: 15px;
            border-bottom: 1px solid #334155;
        }
    </style>
</head>
<body>

    <div class="header">
        <div class="stat-badge">üîã –û—Ñ—Ñ–ª–∞–π–Ω: 3—á –º–∞–∫—Å</div>
        <div class="stat-badge" id="pps-display">0/—Å–µ–∫</div>
    </div>

    <div id="score-container">
        <div id="score">0</div>
    </div>

    <div class="btn-wrapper">
        <button id="click-btn" onclick="handleClick()">
            <span class="h-logo">H</span>
        </button>
    </div>

    <div class="nav-bar">
        <button class="nav-btn" onclick="openOverlay('shop')">üõí <span>–ú–∞–≥–∞–∑–∏–Ω</span></button>
        <button class="nav-btn" onclick="openOverlay('leaders')">üèÜ <span>–õ–∏–¥–µ—Ä—ã</span></button>
    </div>

    <div id="shop" class="overlay">
        <div class="close-btn" onclick="closeOverlays()">‚Üê –ù–∞–∑–∞–¥</div>
        <h2>–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å</h2>
        <div id="shop-list"></div>
    </div>

    <div id="leaders" class="overlay">
        <div class="close-btn" onclick="closeOverlays()">‚Üê –ù–∞–∑–∞–¥</div>
        <h2>–¢–æ–ø –∏–≥—Ä–æ–∫–æ–≤ (–ê–Ω–æ–Ω–∏–º–Ω–æ)</h2>
        <div id="leader-list">
            </div>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();
        tg.enableClosingConfirmation();

        let score = parseFloat(localStorage.getItem('h_score')) || 0;
        let pps = parseFloat(localStorage.getItem('h_pps')) || 0;
        
        const items = [
            { id: 0, name: "CPU i3", pps: 0.5, cost: 50 },
            { id: 1, name: "GPU RTX 4090", pps: 3, cost: 250 },
            { id: 2, name: "ASIC Miner", pps: 12, cost: 1200 },
            { id: 3, name: "–°–µ—Ä–≤–µ—Ä–Ω–∞—è —Å—Ç–æ–π–∫–∞", pps: 50, cost: 7500 },
            { id: 4, name: "–ö–≤–∞–Ω—Ç–æ–≤—ã–π —É–∑–µ–ª", pps: 200, cost: 50000 }
        ];

        let itemCosts = JSON.parse(localStorage.getItem('h_costs')) || items.map(i => i.cost);

        function openOverlay(id) {
            document.getElementById(id).classList.add('active');
            if(id === 'leaders') renderLeaders();
            if(id === 'shop') renderShop();
        }

        function closeOverlays() {
            document.querySelectorAll('.overlay').forEach(el => el.classList.remove('active'));
        }

        function renderShop() {
            let html = '';
            items.forEach((item, i) => {
                html += `
                    <div class="shop-item">
                        <div>
                            <b>${item.name}</b><br>
                            <small style="color:#94a3b8">+${item.pps}/—Å–µ–∫</small>
                        </div>
                        <button class="buy-btn" ${score < itemCosts[i] ? 'disabled' : ''} onclick="buy(${i})">
                            ${Math.floor(itemCosts[i])}
                        </button>
                    </div>
                `;
            });
            document.getElementById('shop-list').innerHTML = html;
        }

        function renderLeaders() {
            let html = '';
            for(let i=1; i<=5; i++) {
                let isYou = i === 1;
                html += `
                    <div class="leader-row" style="${isYou ? 'color:#38bdf8' : ''}">
                        <span>#${i} –ò–≥—Ä–æ–∫_${Math.floor(Math.random()*9000)+1000} ${isYou ? '(–í—ã)' : ''}</span>
                        <b>${isYou ? Math.floor(score) : Math.floor(100000 / i)}</b>
                    </div>
                `;
            }
            document.getElementById('leader-list').innerHTML = html;
        }

        function handleClick() {
            score += 1;
            update();
            // –õ–µ–≥–∫–∞—è –≤–∏–±—Ä–∞—Ü–∏—è –ø—Ä–∏ –∫–ª–∏–∫–µ
            if (tg.HapticFeedback) tg.HapticFeedback.impactOccurred('light');
        }

        function buy(i) {
            if(score >= itemCosts[i]) {
                score -= itemCosts[i];
                pps += items[i].pps;
                itemCosts[i] *= 1.6; // –ò–Ω—Ñ–ª—è—Ü–∏—è 60%
                update();
                renderShop();
                if (tg.HapticFeedback) tg.HapticFeedback.notificationOccurred('success');
            }
        }

        function update() {
            document.getElementById('score').innerText = Math.floor(score);
            document.getElementById('pps-display').innerText = pps.toFixed(1) + '/—Å–µ–∫';
            localStorage.setItem('h_score', score);
            localStorage.setItem('h_pps', pps);
            localStorage.setItem('h_costs', JSON.stringify(itemCosts));
            localStorage.setItem('h_last', Date.now());
        }

        // –û—Ñ—Ñ–ª–∞–π–Ω –¥–æ—Ö–æ–¥
        function checkOffline() {
            let last = localStorage.getItem('h_last');
            if(last && pps > 0) {
                let diff = (Date.now() - parseInt(last)) / 1000;
                let offlineSec = Math.min(diff, 10800); // 3 —á–∞—Å–∞ –º–∞–∫—Å
                if(offlineSec > 10) {
                    let gain = offlineSec * pps;
                    score += gain;
                    alert("–ó–∞ –≤—Ä–µ–º—è –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –Ω–∞–º–∞–π–Ω–µ–Ω–æ: " + Math.floor(gain));
                }
            }
        }

        setInterval(() => {
            score += pps;
            update();
        }, 1000);

        checkOffline();
        update();
    </script>
</body>
</html>
